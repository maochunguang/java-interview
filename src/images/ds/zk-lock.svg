<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="499" height="636" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&quot; version=&quot;7.9.5&quot; editor=&quot;www.draw.io&quot;&gt;&lt;diagram id=&quot;1ada6d7f-d957-1d73-7d83-a6e19a985993&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(3,3)"><path d="M 203 40 L 203 73.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 78.88 L 199.5 71.88 L 203 73.63 L 206.5 71.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 130 L 203 150 L 203 145 L 203 158.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 163.88 L 199.5 156.88 L 203 158.63 L 206.5 156.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="108" y="80" width="190" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(125.5,91.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 156px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">在Zookeeper指定节点Lock下<div>创建临时顺序节点node_n</div></div></div></foreignObject></g><rect x="108" y="165" width="190" height="50" rx="7.5" ry="7.5" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(112.5,176.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 181px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">在Lock节点下获取所有的Childen,<div>并进行排序，获取序号最小的节点</div></div></div></foreignObject></g><path d="M 303 300 L 376.63 300" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 381.88 300 L 374.88 303.5 L 376.63 300 L 374.88 296.5 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 340 L 203 373.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 378.88 L 199.5 371.88 L 203 373.63 L 206.5 371.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 260 L 303 300 L 203 340 L 103 300 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(154.5,286.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="96" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 97px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">判定当前节点序号<div>是否是最小的</div></div></div></foreignObject></g><path d="M 438 320 L 438 353.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 438 358.88 L 434.5 351.88 L 438 353.63 L 441.5 351.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="383" y="280" width="110" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(419.5,293.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 37px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">获得锁</div></div></foreignObject></g><path d="M 438 400 L 438 420 L 438 410 L 438 423.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 438 428.88 L 434.5 421.88 L 438 423.63 L 441.5 421.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="383" y="360" width="110" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(401.5,373.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="72" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">执行业务逻辑</div></div></foreignObject></g><path d="M 438 470 L 438 490 L 438 480 L 438 493.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 438 498.88 L 434.5 491.88 L 438 493.63 L 441.5 491.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="383" y="430" width="110" height="40" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(395.5,443.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="84" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 85px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">删除创建的节点</div></div></foreignObject></g><path d="M 438 540 L 438 580 L 438 583.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 438 588.88 L 434.5 581.88 L 438 583.63 L 441.5 581.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="383" y="500" width="110" height="40" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(419.5,513.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 37px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">释放锁</div></div></foreignObject></g><g transform="translate(334.5,282.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="12" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">是</div></div></foreignObject></g><path d="M 203 215 L 203 253.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 258.88 L 199.5 251.88 L 203 253.63 L 206.5 251.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 420 L 203 440 L 203 430 L 203 443.63" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 203 448.88 L 199.5 441.88 L 203 443.63 L 206.5 441.88 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><rect x="118" y="380" width="170" height="40" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(128.5,386.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 150px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">监听比node_n小的那个节点<br />node_n-1删除事件</div></div></foreignObject></g><g transform="translate(219.5,352.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="12" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">否</div></div></foreignObject></g><path d="M 203 450 L 273 490 L 203 530 L 133 490 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(165.5,476.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="74" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 76px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">node_n-1节点<div>是否删除</div></div></div></foreignObject></g><path d="M 8 490 L 133 490" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 8 300 L 8 490" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 7 299 L 98.63 299" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 103.88 299 L 96.88 302.5 L 98.63 299 L 96.88 295.5 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 273 490 L 338 490" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 337 400 L 337 490" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 294.37 400 L 338 400" fill="none" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><path d="M 289.12 400 L 296.12 396.5 L 294.37 400 L 296.12 403.5 Z" fill="#7ea6e0" stroke="#7ea6e0" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="438" cy="610" rx="20" ry="20" fill="#d5e8d4" stroke="#82b366" pointer-events="none"/><g transform="translate(425.5,603.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 25px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">结束</div></div></foreignObject></g><ellipse cx="203" cy="20" rx="20" ry="20" fill="#d5e8d4" stroke="#82b366" pointer-events="none"/><g transform="translate(190.5,13.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 25px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">开始</div></div></foreignObject></g></g></svg>